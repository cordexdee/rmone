BEGIN TRY
    DECLARE @TableName NVARCHAR(255)
    DECLARE @ColumnName NVARCHAR(255)

    DECLARE table_cursor CURSOR FOR
    SELECT t.name AS TableName, c.name AS ColumnName
FROM sys.tables t
INNER JOIN sys.columns c ON t.object_id = c.object_id 
where type='U' and c.name not in ('Attachments','SubTaskType','TableName','ApplicationRoleAssignUser','SuperintendentUser','AssistantProjectManagerUser','ProjectManagerUser','ProjectExecutiveUser','NewColumn','IconBlob','SearchColumns','SectionConditionalLogic','QuestionMapVariables','ConditionalLogic','AttachmentRequired','BaselineComment','AssignedToUser','Description','ModuleDescription',
'Priority','ModuleStageConstraints','PRPUSer','OwnerUser','ORPUser','Status',
'AdditionalComments','DecisionStatus','ProposedStatus','TaskStatus','CompletedBy','Content','Decision','AssignToPct','Behaviour','GroupUser','IssueImpact',
'ContingencyPlan','MitigationPlan','Resolution','ServiceApplicationAccessXml','definition','TaskGroup','EmailBody','Address',
'VendorIssueImpact','VNDActionType','CustomProperties','EmailIDCC','FinancialManager','History','FunctionalManager','EstimatorUser',
'StageClosedBy','AdditionalCommentsByVendor','InitiatorUser','UserQuestionSummary','ProjectAssumptions','LessonsLearned','ProblemBeingSolved',
'ClassificationImpact','BenefitsExperienced','Job','JobId','ApprovedRFEType','Name','ITManager','Reason','CreatedAt','Data','CreatedBy','Modifiedby',
'Schema','ThemeColor','VendorMeetingAgenda','MeetingMaterial','MeetingFrequencyUnit',
'ResourceUser','VendorAddress','TerminationChargesByVendor','LegalPublicity','LegalWarranties','ServiceDeliveryManager',
'OtherPaymentTerms','PaymentDelayInterest','ProjectStatus','AcceptanceCriteria','PerformanceManager','PRPGroupUser','ProjectScope','RequiredNotifications','ProjectBenefits',
'SharedServices','TaskBehaviour','ColumnValue','TicketTechnologySecurity','OldColumn','UserId','SLAConfiguration','ApproverUser','Approver2User','AssignedByUser','DepartmentManagerUser','DivisionManagerUser','ClosedByUser','BusinessManager2User','Reminders','Kyename','KeyValue','QuestionTypeProperties','QuestionType','Helptext','Counter','AggregatedCounter',
'AcceptanceCriteria',
'AccessManageLevel',
'AccountAddress',
'AccountingManagerUser',
'AccountManager',
'AccountType',
'AcquiredBy',
'ActionType',
'ActionTypeData',
'AdditionalComments',
'AdditionalCommentsByVendor',
'AdditionalInformation',
'Address',
'AdoptionRiskChoice',
'AffectedUsersUser',
'AgentContent',
'AgentJobStatus',
'AgentSummary',
'ALLSLAsMet',
'AlternateOwner',
'AnalysisDetail',
'AnalysisDetails',
'APMUser',
'Application',
'ApplicationManagerUser',
'ApplicationRoleAssignUser',
'ApprenticeArchitectUser',
'ApprovalTypeChoice',
'ApprovedByUser',
'ApprovedRFEType',
'Approver2User',
'ApproverUser',
'ArchitectureScoreNotes',
'ArchitectUser',
'Arguments',
'AssetDescription',
'AssetDispositionChoice',
'AssetLookup',
'AssignedAnalyst',
'AssignedBy',
'AssignedByUser',
'AssignedToUser',
'AssignmentSLAMet',
'AssignToPct',
'AssistantProjectManagerUser',
'AssistantSuperintendentUser',
'AttachmentFormat',
'AttachmentRequired',
'Attachments',
'AuthorizedToView',
'AuthorizedToViewUsers',
'Authors',
'BackupEscalationManagerUser',
'BackupType',
'BaselineComment',
'Behaviour',
'BenefitsExperienced',
'BidArea',
'Blob',
'Body',
'BreakEvenIn',
'BudgetDescription',
'BusinessDevelopmentManagerUser',
'BusinessManager2User',
'BusinessManagerUser',
'CacheMode',
'CampaignInfo',
'CampaignStrategy',
'CampaignUsed',
'CannotStartBeforeNotes',
'CarpenterApprenticeUser',
'CarpenterForemanUser',
'CarpenterUser',
'CategoryChoice',
'Certifications',
'ChanceOfSuccess',
'ChanceOfSuccessChoice',
'ChangePurpose',
'ChartObject',
'ClaimType',
'ClaimValue',
'Clarifications',
'ClassApplied',
'ClassificationChoice',
'ClassificationImpact',
'ClassificationNotes',
'ClassificationScope',
'ClassificationScopeChoice',
'ClassificationSizeChoice',
'ClassificationTypeChoice',
'ClientObligations',
'ClosedByUser',
'CloseSLAMet',
'ColumnType',
'ColumnValue',
'Comment',
'Comments',
'CommercialMgtLead',
'Company',
'CompanyDivision',
'Competition',
'CompletedBy',
'Completeness',
'Complexity',
'ComplexityNotes',
'ComplianceNotes',
'ComponentType',
'ConditionalLogic',
'ConfigString',
'ConstraintNotes',
'Content',
'ContentTypeDisp',
'ContingencyPlan',
'ContractChange',
'ContractChangeComment',
'ContractValueDetails',
'ContributingCauses',
'ContributionToStrategy',
'ControlInfo',
'CorrectiveActions',
'CreatedByUser',
'CRMAdminUser',
'CRMownerUser',
'CRMStatus',
'CRMUser',
'CurrentGWOFields',
'CustomerAccountType',
'CustomerAccountVertical',
'CustomerBenefit',
'CustomerBenefitChoice',
'CustomerProgram',
'CustomerSource',
'CustomField1',
'CustomProperties',
'CustomUGChoice01',
'CustomUGChoice02',
'CustomUGChoice03',
'CustomUGChoice04',
'CustomUGUser01',
'CustomUGUser02',
'CustomUGUser03',
'CustomUGUser04',
'CustomUGUserMulti01',
'CustomUGUserMulti02',
'CustomUGUserMulti03',
'CustomUGUserMulti04',
'DashboardDescription',
'DashboardModuleMultiLookup',
'DashboardPanelInfo',
'DashboardPermissionUser',
'Data',
'Decision',
'DecisionStatus',
'DefaultUser',
'definition',
'DeletedBy',
'DeliverableAttributes',
'DeliverableMode',
'Department',
'DepartmentDescription',
'DepartmentManagerUser',
'DeploymentPlan',
'DeploymentResponsibleUser',
'Description',
'Description1',
'DescriptionofService',
'DesiredCompletionDateNotes',
'DirectorUser',
'Discriminator',
'DistributionQuarter',
'Division',
'DivisionManagerUser',
'DMSDescription',
'DnsNameList',
'DocumentComments',
'DocWorkflowHistory',
'DRBRDescription',
'DRBRImpactChoice',
'DRBRManagerUser',
'DRQChangeTypeChoice',
'DRReplicationChangeChoice',
'EditUser',
'EliminatesHeadcount',
'EmailBody',
'EmailError',
'EmailIDCC',
'EmailIDFrom',
'EmailIDTo',
'EmailReplyTo',
'EmailToTicketSender',
'EmployeeType',
'EnhancedKeyUsageList',
'EscalationDescription',
'EscalationEmailBody',
'EscalationManagerUser',
'EstimatedAmount',
'EstimatorUser',
'EstProjectSpendComment',
'EventReason',
'ExclusionException',
'ExclusionExceptionComment',
'ExpressionXml',
'Extensions',
'ExternalBusinessPartners',
'ExternalID',
'FieldEngineerUser',
'FieldFrequency',
'FieldOperationsManagerUser',
'FieldSetName',
'FieldSetType',
'FieldValues',
'FileLocation',
'FinalCountermeasure',
'FinanceManagerUser',
'FinancialManager',
'FormulaValue',
'FunctionalArea',
'FunctionalAreaDescription',
'FunctionalManager',
'GlobalRoleID',
'GroupEdit',
'GroupLink',
'GroupUser',
'HelpCardLookUp',
'Helptext',
'HelpXml',
'HighLevelRequirements',
'History',
'IconBlob',
'IconUrl',
'ID',
'IdentifiedBy',
'ImageUrl',
'ImpactBusinessGrowthChoice',
'ImpactDecisionMaking',
'ImpactDecisionMakingChoice',
'ImpactIncreasesProductivity',
'ImpactIncreasesProductivityChoice',
'ImpactReducesExpenses',
'ImpactReducesExpensesChoice',
'ImpactReducesRisk',
'ImpactReducesRiskChoice',
'ImpactRevenueIncrease',
'ImpactRevenueIncreaseChoice',
'ImprovesOperationalEfficiency',
'ImprovesRevenues',
'InfrastructureManagerUser',
'InitiatorResolved',
'InitiatorResolvedChoice',
'InitiatorUser',
'InputXml',
'InstalledByUser',
'InterfacesIncoming',
'InterfacesOutgoing',
'InternalCapabilityChoice',
'InternalColumnName',
'InternUser',
'InvestorStatus',
'InvocationData',
'IssueImpact',
'IssueResolutionProcessSummary',
'IssueTypeOptions',
'ITGReviewApproval',
'ITLifecycleRefreshChoice',
'ITManager',
'ITManager2User',
'ITManagerUser',
'ITSteeringCommitteeApproval',
'JuniorDesignerUser',
'Justification',
'KeyValue',
'KeyWords',
'LaborerForemanUser',
'LaborerSuperintendentUser',
'LaborerUser',
'LastReplyByUser',
'LayoutInfo',
'LeadStatus',
'LegalPublicity',
'LegalUser',
'LegalWarranties',
'LessonsLearned',
'Location',
'LocationDescription',
'LocationMultLookup',
'Log',
'MailTo',
'ManagerServiceGroupUser',
'ManagerUser',
'ManufacturerChoice',
'MarketingUser',
'MasterAgreement',
'MeasurementFrequency',
'MeetingFrequencyUnit',
'MeetingMaterial',
'MenuDisplayType',
'MEPCoordinatorUser',
'MEPManagerUser',
'MessageType',
'MetricsNotes',
'MissedSLAsComment',
'MitigationPlan',
'Model',
'ModelXml',
'ModifiedByUser',
'ModuleDescription',
'ModuleNameLookup',
'ModuleType',
'MyEditor',
'NavigationType',
'NavigationUrl',
'NeedReviewChoice',
'NewColumn',
'NoAlternativeOtherDescribe',
'NoOfConsultantsNotes',
'NoOfFTEsNotes',
'NoOfReportsNotes',
'NoOfScreensNotes',
'NotDueSLAsComment',
'Note',
'Notes',
'NotificationText',
'NumUsers2',
'OccurrenceDetails',
'OldColumn',
'OldCRMBusinessUnitChoice',
'OnHoldReason',
'OnHoldReasonChoice',
'OrganizationalImpactChoice',
'OrganizationStatus',
'OrganizationType',
'ORPUser',
'OtherAddress',
'OtherDescribe',
'OtherPaymentTerms',
'OtherSLAMet',
'OtherSLAsComment',
'Outage',
'OwnerBindingChoice',
'OwnerUser',
'OwnerUser2User',
'Parameters',
'Participants',
'PasswordHash',
'PaybackCostSavings',
'PaymentDelayInterest',
'PaymentTerms',
'PerformanceManager',
'PhoneNumber',
'PictureDisp',
'PingComments',
'PingUser',
'PlannedActivities',
'PONumber',
'PortalDescription',
'PreConAdminUser',
'PreconCoordinatorUser',
'PreConstruction',
'PreparedBy',
'PreviousOwner1User',
'PreviousOwner2User',
'PreviousOwner3User',
'Priority',
'ProblemBeingSolved',
'ProcoreColumnName',
'ProductCode',
'ProductionVerificationPlan',
'ProductionVerifyResponsibleUser',
'ProgramManagerUser',
'ProjectAssumptions',
'ProjectAssumptionsDescription',
'ProjectAuditorUser',
'ProjectBenefits',
'ProjectBenefitsDescription',
'ProjectComplexity',
'ProjectComplexityChoice',
'ProjectConstraints',
'ProjectCoordinators',
'ProjectCostNote',
'ProjectDeliverables',
'ProjectDirector',
'ProjectDirectorUser',
'ProjectEngineerUser',
'ProjectExecutiveUser',
'ProjectManagerArchitectureUser',
'ProjectManagerServiceGroupUser',
'ProjectManagerUser',
'ProjectMonitorNotes',
'ProjectNote',
'ProjectNoteType',
'ProjectRisk',
'ProjectRiskNotes',
'ProjectScheduleNote',
'ProjectScope',
'ProjectScopeDescription',
'ProjectScoreNotes',
'ProjectStatus',
'ProjectSummaryNote',
'ProposedStatus',
'PRPGroupUser',
'PRPUser',
'PurchasedBy',
'PurchaseInstructions',
'PurchasingUser',
'Quality',
'QualityControlCoordinatorUser',
'QuestionMapVariables',
'QuestionType',
'QuestionTypeProperties',
'RapidRequest',
'RCATypeChoice',
'RecoveryPlan',
'RecurrenceData',
'RecurrenceInfo',
'ReducesCost',
'RefreshMode',
'RegisteredByUser',
'Regulatory',
'RegulatoryChoice',
'RegulatoryCompliance',
'ReminderBody',
'ReminderInfo',
'Reminders',
'ReminderType',
'RepeatIntervalChoice',
'ReplacementTypeChoice',
'ReportFrequencyType',
'ReportingFrequencyUnit',
'ReportInstanceStatus',
'ReportMonthFrequencyType',
'ReportTitle',
'ReportType',
'RequestCategory',
'Requested_By',
'RequestorContactSLAMet',
'RequestorUser',
'RequestParams',
'RequestSource',
'RequestSourceChoice',
'RequiredNotifications',
'ResoltuonComments',
'Resolution',
'ResolutionComments',
'ResolutionSLAMet',
'ResolutionType',
'ResolutionTypeChoice',
'ResolutionTypes',
'ResolvedBy',
'ResolvedByUser',
'ResourceIDs',
'ResourceUser',
'ResourceUserAllocated',
'Responsible',
'RiskChoice',
'RiskScoreNotes',
'Role',
'RoleNameChoice',
'RollbackResponsibleUser',
'RootCause',
'RootCauseAnalysis',
'RootCauseAnalysisComment',
'SafetyManagerUser',
'ScheduleComplexity',
'ScheduleStatusChoice',
'ScopeOfServices',
'ScoreSegmentXml',
'SearchColumns',
'SectionConditionalLogic',
'SecurityDescription',
'SecurityStamp',
'SelectedTabs',
'SeniorEstimatorUser',
'SeniorManagerAccountingUser',
'SeniorManagerServicesGroupUser',
'SeniorMEPManagerUser',
'SeniorProjectManagerUser',
'SeniorSuperintendentUser',
'ServerDomain',
'ServerStorageType',
'ServiceApplicationAccessXml',
'ServiceChargeType',
'ServiceCoordinatorUser',
'ServiceDeliveryManager',
'ServiceDescription',
'ServiceFrequency',
'ServiceInfo',
'SetupCompletedByUser',
'Severity',
'SharedServices',
'SipAddress',
'SkipOnCondition',
'SLACategoryChoice',
'SLAComments',
'SLAConfiguration',
'SLADaysRoundUpDownChoice',
'SLAsMetComment',
'SLAUnit',
'SLCreditsDue',
'SLCreditsDueComment',
'SLDefaults',
'SLDefaultsComment',
'SourceDetails',
'SOWContinuousImprovementPeriodUnit',
'SOWFeeUnit',
'SOWFeeUnit2',
'SpecificExclusions',
'SpecificInclusions',
'StageActionUsersUser',
'StageClosedBy',
'Status',
'StrategicInitiative',
'StrategicInitiativeChoice',
'StreetAddress',
'StudioDirectorUser',
'SubMenuStyle',
'SubTaskType',
'SuperintendentUser',
'SupplierChoice',
'SupportedBusinessProcesses',
'SustainabilityAssociateUser',
'SustainabilityCoordinatorUser',
'SustainbilityAssociateUser',
'SustainbilityCoordinatorUser',
'SystemPurpose',
'TableName',
'TagMultiLookup',
'TaskBehaviour',
'TaskGroup',
'TaskID',
'TaskStatus',
'TaskType',
'Technology',
'TechnologyAvailability',
'TechnologyImpact',
'TechnologyImpactChoice',
'TechnologyIntegration',
'TechnologyNotes1',
'TechnologyReliabilityChoice',
'TechnologyRisk',
'TechnologySecurityChoice',
'TechnologyUsabilityChoice',
'Template',
'TemporaryCountermeasure',
'TenantID',
'TenantRegistrationdata',
'TerminationChargesByVendor',
'TermTypeChoice',
'Tester2User',
'TesterUser',
'TestingDoneChoice',
'TestPlan',
'TextAlignmentChoice',
'TextMenuAlignment',
'ThemeColor',
'TicketClassificationScope',
'TicketClassificationSize',
'TicketTechnologyReliability',
'TicketTechnologySecurity',
'TicketTechnologyUsability',
'Timeliness',
'Title',
'TotalConsultantHeadcountNotes',
'TotalCostsNotes',
'TotalOffSiteConsultantHeadcountNotes',
'TotalOnSiteConsultantHeadcountNotes',
'TotalStaffHeadcountNotes',
'Trade',
'UGITDescription',
'UGITNewUserDisplayName',
'UpgradeChoice',
'UserCertificateLookup',
'UserFieldXML',
'UserId',
'UserImpactDetails',
'UserInfoHidden',
'UserQuestionSummary',
'UserSelection',
'UserSkillLookup',
'UserTypes',
'Value',
'VendorAddress',
'VendorIssueImpact',
'VendorMeetingAgenda',
'VendorRiskImpact',
'VendorSLAMet',
'VendorSupport',
'VendorSupportChoice',
'ViewType',
'VNDActionType',
'Waiver',
'WaiverComment',
'Why1',
'Why2',
'Why3',
'Why4',
'Why5',
'WhyFinal',
'WikiDescription',
'WikiDislikedByUser',
'WikiHistory',
'WikiLikedByUser',
'WikiLookUp',
'WorkAddress',
'WorkDescription',
'WorkflowTaskStatus',
'XMLTZone',
'$LifeTime',
'CompletionMessage',
'ProposalRecipientLookup',
'AdditionalRecipientsLookup','OldPics','AdministratorUser','TestField1User','TestField2User','TechnicalLeadUser','ManagerLookup','CategoryName','KeyName'
,'Predecessors','DRQSystemsLookup','BusinessAnalystUser'
) 
and c.name not like '%AuthorizedTo%' and c.name not like '%Choice%' and c.name not like '%Resolution%' and c.name not like '%Note%' and c.name not like '%Comment%' and c.name not like '%Custom%' and c.name not like '%url%' and c.name not like '%Description%' and c.name not like '%Details%' and c.name not like '%Information%'
and t.name in ('ACR',
'ACRTypes',
'Agents',
'ApplicationAccess',
'ApplicationModules',
'ApplicationPassword',
'ApplicationRole',
'Applications',
'ApplicationServers',
'Appointment',
'AspNetRoles',
'AspNetUserClaims',
'AspNetUserLogins',
'AspNetUserRoles',
'AspNetUsers',
'AssetIncidentRelations',
'AssetModels',
'AssetReferences',
'AssetRelations',
'Assets',
'AssetsStatus',
'AssetVendors',
'AvailableManagedServices',
'BaselineDetails',
'BTS',
'BusinessStrategy',
'BusinessUnits',
'ChartFilters',
'Company',
'CompanyDivisions',
'Config_BudgetCategories',
'Config_ClientAdminCategory',
'Config_ConfigurationVariable',
'Config_Dashboard_DashboardFactTables',
'Config_Dashboard_DashboardPanels',
'Config_Dashboard_DashboardPanelView',
'Config_LeadCriteria',
'Config_MailTokenColumnName',
'Config_Master_RankingCriteria',
'Config_MenuNavigation',
'Config_Module_DefaultValues',
'Config_Module_EscalationRule',
'Config_Module_FormLayout',
'Config_Module_Impact',
'Config_Module_ModuleColumns',
'Config_Module_ModuleFormTab',
'Config_Module_ModuleStages',
'Config_Module_ModuleUserTypes',
'Config_Module_Priority',
'Config_Module_RequestPriority',
'Config_Module_RequestRoleWriteAccess',
'Config_Module_RequestType',
'Config_Module_Severity',
'Config_Module_SLARule',
'Config_Module_StageType',
'Config_Module_StatusMapping',
'Config_Module_TaskEmails',
'Config_ModuleLifeCycles',
'Config_ModuleMonitorOptions',
'Config_ModuleMonitors',
'Config_Modules',
'Config_PageConfiguration',
'Config_ProjectClass',
'Config_ProjectComplexity',
'Config_ProjectInitiative',
'Config_ProjectLifeCycleStages',
'Config_Service_ServiceCategories',
'Config_Service_ServiceColumns',
'Config_Service_ServiceDefaultValues',
'Config_Service_ServiceQuestions',
'Config_Service_ServiceRelationships',
'Config_Service_ServiceSections',
'Config_Services',
'Config_TabView',
'Config_UserRoles',
'Config_VendorResourceCategory',
'Config_WikiLeftNavigation',
'Contacts',
'CRMActivities',
'CRMCompany',
'CRMContact',
'CRMEstimate',
'CRMProject',
'CRMProjectAllocation',
'CRMRelationshipType',
'CRMServices',
'DashboardSummary',
'Department',
'DepartmentRoleMapping',
'DRQ',
'DRQRapidTypes',
'DRQSystemAreas',
'EmployeeTypes',
'Environment',
'EscalationLog',
'EscalationQueue',
'ExperiencedTags',
'FieldConfiguration',
'FieldConfigurationChanges',
'FunctionalAreas',
'GenericStatus',
'GovernanceLinkCategory',
'GovernanceLinkItems',
'INC',
'ITGActual',
'ITGBudget',
'ITGMonthlyBudget',
'ITGovernance',
'JobTitle',
'LandingPages',
'Lead',
'LeadRanking',
'LinkCategory',
'LinkItems',
'LinkView',
'Location',
'ModuleBudget',
'ModuleBudgetActuals',
'ModuleBudgetActualsHistory',
'ModuleBudgetHistory',
'ModuleMonitorOptionsHistory',
'ModuleMonthlyBudget',
'ModuleMonthlyBudgetHistory',
'ModuleStageConstraints',
'ModuleStageConstraintTemplates',
'ModuleTasks',
'ModuleUserStatistics',
'ModuleWorkflowHistory',
'MonthlyBudget',
'NPR',
'NPRBudget',
'NPRMonthlyBudget',
'NPRResources',
'NPRTasks',
'Opportunity',
'PMM',
'PMMIssues',
'PMMIssuesHistory',
'PMMMonthlyBudget',
'PMMMonthlyBudgetHistory',
'PMMRisks',
'PMMTasks',
'PMMTasksHistory',
'ProjectAllocationTemplates',
'ProjectEstimatedAllocation',
'ProjectMonitorState',
'ProjectMonitorStateHistory',
'ProjectPlannedAllocation',
'ProjectReleases',
'ProjectSimilarityConfig',
'ProjectSimilarityMetrics',
'ProjectStageHistory',
'ProjectStandardWorkItems',
'RCA',
'Relationship',
'RequestTypeByLocation',
'ResourceAllocation',
'ResourceAllocationMonthly',
'ResourceTimeSheet',
'ResourceTimeSheetSignOff',
'ResourceUsageSummaryMonthWise',
'ResourceUsageSummaryWeekWise',
'ResourceWorkItems',
'RoleBillingRateByDept',
'Roles',
'Sprint',
'SprintSummary',
'SprintTasks',
'State',
'Studio',
'SVCRequests',
'TaskTemplateItems',
'TaskTemplates',
'Templates',
'TicketCountTrends',
'TicketHours',
'TicketRelation',
'TSK',
'TSKTasks',
'TSR',
'UserCertificates',
'UserProjectExperience',
'UserSkills')

    OPEN table_cursor
    FETCH NEXT FROM table_cursor INTO @TableName, @ColumnName

    WHILE @@FETCH_STATUS = 0
    BEGIN
        DECLARE @SQL NVARCHAR(MAX)
        SET @SQL = 'CREATE INDEX IX_' + @TableName + '_' + @ColumnName + ' ON ' + @TableName + ' (' + @ColumnName + ')'
        
        BEGIN TRY
            IF EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(@TableName) AND name = 'IX_' + @TableName + '_' + @ColumnName)
            BEGIN
                EXEC('DROP INDEX IX_' + @TableName + '_' + @ColumnName + ' ON ' + @TableName)
            END
            EXEC sp_executesql @SQL
        END TRY
        BEGIN CATCH
            PRINT 'Error creating/dropping index for table ' + @TableName + ', column ' + @ColumnName
            PRINT 'Error Message: ' + ERROR_MESSAGE()
        END CATCH

        FETCH NEXT FROM table_cursor INTO @TableName, @ColumnName
    END

    CLOSE table_cursor
    DEALLOCATE table_cursor
END TRY
BEGIN CATCH
    Print 'This is the CATCH block within : ' + 
        'Error Message: ' + ERROR_MESSAGE() + 
        ' Error Line: ' + CONVERT(VARCHAR, ERROR_LINE()) + 
        ' @TableName: ' + ISNULL(@TableName, 'NULL') +
        ' @ColumnName: ' + ISNULL(@ColumnName, 'NULL') +
        ' @SQL: ' + ISNULL(@SQL, 'NULL')
END CATCH
