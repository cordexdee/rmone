Declare @TenantId varchar(123)= '35525396-E5FE-4692-9239-4DF9305B915B',@Startdate datetime ='2021-01-01 00:00:00.000',@Endate datetime ='2021-07-31 00:00:00.000'declare @noOfBillableResource intselect @noOfBillableResource = count(1) from AspNetUsers u join JobTitle jt on u.JobTitleLookup = jt.ID whereu.TenantID = @TenantId and jt.TenantID = @TenantId andjt.JobType='Billable'Select LEFT(DATENAME(m,a.MonthStartDate), 3) Months, CAST(Sum(a.PctAllocation)/@noOfBillableResource as decimal(24,2)) BilledResource, Abs(round((Sum(a.PctAllocation)),2) - 100) UnBilledResource, Month(a.MonthStartDate) as MonthDays from ResourceAllocationMonthly a 	Where a.TenantID=@TenantId	and a.monthstartdate >= @Startdate and a.monthstartdate  <= @Endate	and a.ResourceUser = '00000000-0000-0000-0000-000000000000'	group by  DATENAME(m,a.MonthStartDate), Month(a.MonthStartDate) --order by Month(a.MonthStartDate)